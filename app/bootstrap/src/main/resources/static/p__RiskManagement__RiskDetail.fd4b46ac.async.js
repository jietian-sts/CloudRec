(self.webpackChunk=self.webpackChunk||[]).push([[3635],{82826:function(R,h,e){"use strict";e.d(h,{Z:function(){return i}});var o=e(87462),d=e(62435),c={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M872 474H286.9l350.2-304c5.6-4.9 2.2-14-5.2-14h-88.5c-3.9 0-7.6 1.4-10.5 3.9L155 487.8a31.96 31.96 0 000 48.3L535.1 866c1.5 1.3 3.3 2 5.2 2h91.5c7.4 0 10.8-9.2 5.2-14L286.9 550H872c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}}]},name:"arrow-left",theme:"outlined"},_=c,j=e(84089),g=function(O,l){return d.createElement(j.Z,(0,o.Z)({},O,{ref:l,icon:_}))},y=d.forwardRef(g),i=y},69055:function(R,h,e){"use strict";e.d(h,{Z:function(){return P}});var o=e(22181),d=e(83622),c=e(87462),_=e(62435),j={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M464 688a48 48 0 1096 0 48 48 0 10-96 0zm24-112h48c4.4 0 8-3.6 8-8V296c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8z"}}]},name:"exclamation-circle",theme:"outlined"},g=j,y=e(84089),i=function(M,u){return _.createElement(y.Z,(0,c.Z)({},M,{ref:u,icon:g}))},f=_.forwardRef(i),O=f,l=e(45830),v={noPermissionContainer:"noPermissionContainer___mfh3D","ant-result":"ant-result___HwWPh","ant-result-icon":"ant-result-icon___kCRak",anticon:"anticon___dFq4q","ant-result-title":"ant-result-title___qzgxn","ant-result-subtitle":"ant-result-subtitle___wgaK1","ant-result-extra":"ant-result-extra___YuiiI","ant-btn":"ant-btn___SR44Y",dark:"dark___6IwTX",fadeInUp:"fadeInUp___lq2_S"},m=e(86074),r=function(M){var u=M.title,s=M.subTitle,C=M.showReturnButton,x=C===void 0?!0:C,E=M.onReturn,D=(0,l.useIntl)(),T=function(){E?E():l.history===null||l.history===void 0||l.history.push("/")};return(0,m.jsx)("div",{className:v.noPermissionContainer,children:(0,m.jsx)(o.ZP,{icon:(0,m.jsx)(O,{}),status:"403",title:u||D.formatMessage({id:"common.message.text.no.permission.title"}),subTitle:s||D.formatMessage({id:"common.message.text.no.permission.subtitle"}),extra:x&&(0,m.jsx)(d.ZP,{type:"primary",onClick:T,children:D.formatMessage({id:"common.button.text.return"})})})})},P=r},24163:function(R,h,e){"use strict";var o=e(97857),d=e.n(o),c=e(25593),_=e(83062),j=e(62435),g=e(86074),y=c.Z.Paragraph;h.Z=function(i){var f=i.text,O=i.width,l=i.maxWidth,v=i.rows,m=v===void 0?2:v,r=i.placement,P=r===void 0?"top":r,a=i.color,M=a===void 0?"rgba(0, 0, 0, 0.88)":a,u=i.link,s=u===void 0?!1:u,C=i.onClickCallBackFunc,x=i.style,E=x===void 0?{}:x,D=i.copyable,T=D===void 0?!1:D;return(0,g.jsx)("div",{style:{maxWidth:l,width:O},children:(0,g.jsx)(_.Z,{title:(0,g.jsx)("div",{children:f}),placement:P,children:(0,g.jsx)(y,{ellipsis:{rows:m},style:d()({marginBottom:0,color:M,cursor:s?"pointer":""},E),onClick:C,copyable:T,children:f})})})}},52078:function(R,h,e){"use strict";var o=e(97857),d=e.n(o),c=e(27997),_=e(62435),j=e(86074),g=function(i){c.Mj.register({id:"json"});var f=i.value,O=f===void 0?"{}":f,l=i.onChange,v=i.editorStyle,m=v===void 0?{}:v,r=i.editorKey,P=r===void 0?"json-editor":r,a=i.readOnly,M=a===void 0?!1:a,u=(0,_.useRef)(),s=(0,_.useRef)(),C=function(){var E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"{}";try{return JSON.parse(E),E}catch(D){return console.warn("Invalid JSON string:",D),"{}"}};return(0,_.useEffect)(function(){if(u.current)return s.current?s.current.setValue(O):(s.current=c.j6.create(u.current,{value:C(O),language:"json",theme:"vs",readOnly:M,folding:!0,automaticLayout:!0}),s.current.onDidChangeModelContent(function(){var x=s.current.getValue();console.log("[JSONEditor] \u7F16\u8F91\u5668\u5185\u5BB9\u53D8\u66F4:",{newValue:x}),l==null||l(x)})),function(){if(s!=null&&s.current){var x;s==null||(x=s.current)===null||x===void 0||x.dispose(),s.current=null}}},[]),(0,_.useEffect)(function(){s.current&&O!==s.current.getValue()&&s.current.setValue(C(O))},[O]),(0,j.jsx)("div",{ref:u,style:d()({height:360,borderRadius:4,overflow:"hidden"},m)},P)};h.Z=g},29297:function(R,h,e){"use strict";e.d(h,{q9:function(){return o.Z},Wy:function(){return i},mi:function(){return v}});var o=e(52078),d=e(97857),c=e.n(d),_=e(55171),j=e.n(_),g=e(86074),y=function(r){var P=r.value,a=r.viewerStyle,M=a===void 0?{}:a,u=r.displayDataTypes,s=u===void 0?!1:u,C=r.name,x=C===void 0?"output json":C;return(0,g.jsx)(j(),{src:P,name:x,collapsed:!1,displayDataTypes:s,style:c()({height:360,padding:12,overflow:"scroll",borderRadius:4,background:"#FFF"},M)})},i=y,f=e(27997),O=e(62435),l=function(r){f.Mj.register({id:"rego"});var P=r.value,a=r.onChange,M=r.editorStyle,u=M===void 0?{}:M,s=r.editorKey,C=r.readOnly,x=C===void 0?!1:C,E=(0,O.useRef)(),D=(0,O.useRef)();return(0,O.useEffect)(function(){if(E.current)return D.current||(D.current=f.j6.create(E.current,{value:P,language:"rego",theme:"vs",readOnly:x,automaticLayout:!0}),D.current.onDidChangeModelContent(function(){a==null||a(D.current.getValue())})),function(){if(D.current){var T;(T=D.current)===null||T===void 0||T.dispose(),D.current=null}}},[]),(0,g.jsx)("div",{ref:E,style:c()({width:"100%",height:760,borderRadius:4,overflow:"hidden"},u)},s)},v=l},35469:function(R,h,e){"use strict";e.r(h);var o=e(5574),d=e.n(o),c=e(87426),_=e(39421),j=e(24163),g=e(69055),y=e(71448),i=e(96364),f=e(47908),O=e(72028),l=e(29448),v=e(82826),m=e(45742),r=e(39380),P=e(93410),a=e(45830),M=e(25593),u=e(83622),s=e(86250),C=e(4393),x=e(42075),E=e(66309),D=e(83062),T=e(21532),A=e(99859),L=e(62435),G=e(24482),X=e(50322),Y=e(22145),n=e(86074),S=M.Z.Text,Q=function(){var b,W,B,U,Z,K,q=(0,a.useLocation)(),ee=new URLSearchParams(q.search),te=(0,L.useState)(ee.get("id")),ne=d()(te,1),k=ne[0],p=(0,a.useIntl)(),se=(0,a.useModel)("rule"),re=se.platformList,oe=(0,a.useModel)("tenant"),V=oe.tenantListAll,ie=(0,L.useState)(!1),w=d()(ie,2),le=w[0],ae=w[1],de=(0,L.useState)(!1),$=d()(de,2),ue=$[0],H=$[1],ce=(0,L.useState)(!1),J=d()(ce,2),_e=J[0],z=J[1],N=(0,a.useRequest)(function(I){return(0,O.queryRiskDetailById)({riskId:I})},{manual:!0,formatResult:function(F){return F.code===403&&z(!0),F.content||{}},onError:function(F){z(!0)}}),t=N.data,ve=N.run,me=N.loading;return(0,L.useEffect)(function(){k&&ve(k)},[k]),_e?(0,n.jsx)(r._z,{breadcrumbRender:!1,title:(0,n.jsxs)(u.ZP,{type:"link",size:"small",onClick:function(){return a.history===null||a.history===void 0?void 0:a.history.back()},children:[(0,n.jsx)(v.Z,{})," ",p.formatMessage({id:"common.button.text.return"})]}),className:f.Z.riskDetailContainer,children:(0,n.jsx)(g.Z,{})}):(0,n.jsx)(r._z,{loading:me,breadcrumbRender:!1,title:(0,n.jsx)(s.Z,{justify:"space-between",align:"center",style:{width:"100%"},children:(0,n.jsxs)(u.ZP,{type:"link",size:"small",onClick:function(){return a.history===null||a.history===void 0?void 0:a.history.back()},children:[(0,n.jsx)(v.Z,{})," ",p.formatMessage({id:"common.button.text.return"})]})}),className:f.Z.riskDetailContainer,children:(0,n.jsxs)(C.Z,{className:f.Z.riskDetailAroundCard,children:[(0,n.jsxs)(P.Z,{style:{marginBottom:18},bodyStyle:{backgroundColor:"#f9f9f9",padding:"16px 20px"},children:[(0,n.jsx)(s.Z,{justify:"space-between",align:"center",style:{marginBottom:10},children:(0,n.jsxs)("span",{children:[(0,n.jsx)(S,{style:{marginRight:12},children:(0,n.jsx)(u.ZP,{type:"link",href:"/ruleManagement/ruleProject/edit?id=".concat(t==null?void 0:t.ruleId),target:"_blank",style:{padding:"4px 0 4px 4px",fontSize:"18px"},children:(t==null||(b=t.ruleVO)===null||b===void 0?void 0:b.ruleName)||"-"})}),(0,n.jsxs)(x.Z,{children:[(0,n.jsx)("span",{children:(0,l.Ff)(i.MW,t==null?void 0:t.status)}),(t==null?void 0:t.ignoreReasonType)&&(0,n.jsxs)("span",{children:[(0,n.jsxs)(S,{style:{marginRight:8,color:"rgba(127, 127, 127, 1)"},children:[p.formatMessage({id:"risk.module.text.ignore.type"}),"\xA0:\xA0"]}),(0,n.jsx)(E.Z,{color:"geekblue",children:((W=i.$G.find(function(I){return I.value===(t==null?void 0:t.ignoreReasonType)}))===null||W===void 0?void 0:W.label)||"-"})]}),(t==null?void 0:t.ignoreReason)&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(S,{style:{marginRight:8,color:"rgba(127, 127, 127, 1)"},children:[p.formatMessage({id:"risk.module.text.ignore.reason"}),"\xA0:\xA0"]}),(0,n.jsx)(j.Z,{rows:1,text:t==null?void 0:t.ignoreReason,maxWidth:64})]})]})]})}),(0,n.jsxs)(s.Z,{vertical:!0,gap:10,children:[(0,n.jsxs)(s.Z,{align:"center",children:[(0,n.jsx)("img",{src:_.Z,alt:"DISCOVER_ICON",style:{width:14,height:14}}),(0,n.jsxs)("span",{style:{color:"rgba(127, 127, 127, 1)",margin:"0 8px 0 6px"},children:[p.formatMessage({id:"risk.module.text.recently.scanned.hits"}),"\xA0:\xA0"]}),(0,n.jsx)("span",{style:{color:"rgba(51, 51, 51, 1)"},children:t==null?void 0:t.gmtModified})]}),(0,n.jsxs)(S,{children:[(0,n.jsx)("img",{src:c.Z,alt:"DISCOVER_ICON",style:{width:14,height:14}}),(0,n.jsxs)("span",{style:{color:"rgba(127, 127, 127, 1)",margin:"0 8px 0 6px"},children:[p.formatMessage({id:"risk.module.text.first.discovery.time"}),"\xA0:\xA0"]}),(0,n.jsx)("span",{style:{color:"rgba(51, 51, 51, 1)"},children:t==null?void 0:t.gmtCreate})]})]}),(0,n.jsxs)(s.Z,{align:"center",style:{margin:"10px 0 6px 0"},children:[(0,n.jsxs)("span",{style:{marginRight:8,color:"rgba(127, 127, 127, 1)"},children:[p.formatMessage({id:"common.select.label.cloudAccount"}),"\xA0:\xA0"]}),(0,n.jsx)("span",{style:{color:"rgba(51, 51, 51, 1)",marginRight:16},children:(t==null?void 0:t.cloudAccountId)||"-"}),(0,n.jsx)("span",{style:{color:"rgba(127, 127, 127, 1)",marginRight:16},children:(t==null?void 0:t.alias)||"-"})]}),(0,n.jsxs)(s.Z,{justify:"start",align:"center",style:{margin:"10px 0 6px 0"},children:[(0,n.jsx)("span",{style:{marginRight:5,color:"rgba(127, 127, 127, 1)"},children:(0,l.fD)(t==null?void 0:t.platform,re)}),(0,n.jsx)(S,{style:{marginRight:20,color:"rgba(127, 127, 127, 1)"},children:(t==null?void 0:t.resourceType)||"-"}),(0,n.jsxs)(s.Z,{align:"center",children:[(0,n.jsx)("span",{style:{marginRight:4,color:"rgba(127, 127, 127, 1)"},children:(t==null?void 0:t.resourceName)+" / "+(t==null?void 0:t.resourceId)}),(0,n.jsx)(D.Z,{title:p.formatMessage({id:"asset.extend.text.detail"}),children:(0,n.jsx)("span",{className:f.Z.iconWrap,onClick:function(){return H(!0)},children:(0,n.jsx)(m.Z,{className:f.Z.resourceInstance})})})]}),(0,n.jsx)(S,{style:{color:"rgba(127, 127, 127, 1)",margin:"0 12px"},children:(V==null||(B=V.find(function(I){return I.value===(t==null?void 0:t.tenantId)}))===null||B===void 0?void 0:B.label)||"-"})]})]}),(0,n.jsx)(T.ZP,{theme:{components:{Form:{itemMarginBottom:8,labelColor:"rgba(127, 127, 127, 1)",labelColonMarginInlineEnd:16}}},children:(0,n.jsxs)(A.Z,{children:[(0,n.jsx)(A.Z.Item,{label:p.formatMessage({id:"rule.module.text.repair.suggestions"}),children:(0,n.jsx)("span",{style:{color:"rgb(51, 51, 51)"},children:(t==null||(U=t.ruleVO)===null||U===void 0?void 0:U.advice)||"-"})}),(0,n.jsx)(A.Z.Item,{label:p.formatMessage({id:"risk.module.text.reference.link"}),children:(0,n.jsx)("span",{style:{color:"rgb(51, 51, 51)"},children:(t==null||(Z=t.ruleVO)===null||Z===void 0?void 0:Z.link)||"-"})}),(0,n.jsx)(A.Z.Item,{label:p.formatMessage({id:"rule.module.text.rule.describe"}),children:(0,n.jsx)("span",{style:{color:"rgb(51, 51, 51)"},children:(t==null||(K=t.ruleVO)===null||K===void 0?void 0:K.ruleDesc)||"-"})})]})}),(0,n.jsx)(y.Z,{riskDrawerInfo:t}),(0,n.jsx)(X.Z,{riskDrawerInfo:t}),(0,n.jsx)(G.Z,{evaluateDrawerVisible:le,setEvaluateDrawerVisible:ae,riskDrawerInfo:t}),(0,n.jsx)(Y.Z,{resourceDrawerVisible:ue,setResourceDrawerVisible:H,riskDrawerInfo:t})]})})};h.default=Q},53846:function(R,h){"use strict";h.Z={customTitle:"customTitle___nzcxh",riskHigh:"riskHigh___GstO6",riskMedium:"riskMedium___F4JTb",riskLow:"riskLow___HJopw",imgProcess:"imgProcess___NGndv",imgResult:"imgResult___wKhiG",validTag:"validTag___TRSau",invalidTag:"invalidTag___opVlG",waitingTag:"waitingTag___JZpZT"}},69760:function(R,h,e){"use strict";e.d(h,{Z:function(){return O},w:function(){return y}});var o=e(62435),d=e(97937),c=e(64217),_=e(10110),j=e(24457),g=e(38780);function y(l){if(l)return{closable:l.closable,closeIcon:l.closeIcon}}function i(l){const{closable:v,closeIcon:m}=l||{};return o.useMemo(()=>{if(!v&&(v===!1||m===!1||m===null))return!1;if(v===void 0&&m===void 0)return null;let r={closeIcon:typeof m!="boolean"&&m!==null?m:void 0};return v&&typeof v=="object"&&(r=Object.assign(Object.assign({},r),v)),r},[v,m])}const f={};function O(l,v,m=f){const r=i(l),P=i(v),[a]=(0,_.Z)("global",j.Z.global),M=typeof r!="boolean"?!!(r!=null&&r.disabled):!1,u=o.useMemo(()=>Object.assign({closeIcon:o.createElement(d.Z,null)},m),[m]),s=o.useMemo(()=>r===!1?!1:r?(0,g.Z)(u,P,r):P===!1?!1:P?(0,g.Z)(u,P):u.closable?u:!1,[r,P,u]);return o.useMemo(()=>{if(s===!1)return[!1,null,M,{}];const{closeIconRender:C}=u,{closeIcon:x}=s;let E=x;const D=(0,c.Z)(s,!0);return E!=null&&(C&&(E=C(x)),E=o.isValidElement(E)?o.cloneElement(E,Object.assign({"aria-label":a.close},D)):o.createElement("span",Object.assign({"aria-label":a.close},D),E)),[!0,E,M,D]},[s,u])}},16569:function(R,h,e){"use strict";e.d(h,{H:function(){return j}});var o=e(62435),d=e(66680);function c(){}const _=o.createContext({add:c,remove:c});function j(y){const i=o.useContext(_),f=o.useRef(null);return(0,d.Z)(l=>{if(l){const v=y?l.querySelector(y):l;i.add(v),f.current=v}else i.remove(f.current)})}var g=null},85674:function(R,h,e){var o={"./simpleWorker":18352,"./simpleWorker.js":18352};function d(c){return Promise.resolve().then(function(){if(!e.o(o,c)){var _=new Error("Cannot find module '"+c+"'");throw _.code="MODULE_NOT_FOUND",_}var j=o[c];return e(j)})}d.keys=function(){return Object.keys(o)},d.id=85674,R.exports=d},10131:function(R,h,e){var o={"./editorBaseApi":[20927],"./editorBaseApi.js":[20927],"./editorSimpleWorker":[81465],"./editorSimpleWorker.js":[81465],"./editorWorker":[85215],"./editorWorker.js":[85215],"./editorWorkerHost":[98008],"./editorWorkerHost.js":[98008],"./findSectionHeaders":[72846],"./findSectionHeaders.js":[72846],"./getIconClasses":[22016],"./getIconClasses.js":[22016],"./languageFeatureDebounce":[88191],"./languageFeatureDebounce.js":[88191],"./languageFeatures":[71922],"./languageFeatures.js":[71922],"./languageFeaturesService":[7421],"./languageFeaturesService.js":[7421],"./languageService":[81032],"./languageService.js":[81032],"./languagesAssociations":[73536],"./languagesAssociations.js":[73536],"./languagesRegistry":[4765],"./languagesRegistry.js":[4765],"./markerDecorations":[36357],"./markerDecorations.js":[36357],"./markerDecorationsService":[86036],"./markerDecorationsService.js":[86036],"./model":[73733],"./model.js":[73733],"./modelService":[51200],"./modelService.js":[51200],"./resolverService":[88216],"./resolverService.js":[88216],"./semanticTokensDto":[14704],"./semanticTokensDto.js":[14704],"./semanticTokensProviderStyling":[92294],"./semanticTokensProviderStyling.js":[92294],"./semanticTokensStyling":[73343],"./semanticTokensStyling.js":[73343],"./semanticTokensStylingService":[84146],"./semanticTokensStylingService.js":[84146],"./textModelSync/textModelSync.impl":[28944],"./textModelSync/textModelSync.impl.js":[28944],"./textModelSync/textModelSync.protocol":[23145,3145],"./textModelSync/textModelSync.protocol.js":[23145,3145],"./textResourceConfiguration":[71765],"./textResourceConfiguration.js":[71765],"./treeSitterParserService":[28922],"./treeSitterParserService.js":[28922],"./treeViewsDnd":[80642],"./treeViewsDnd.js":[80642],"./treeViewsDndService":[58345],"./treeViewsDndService.js":[58345],"./unicodeTextModelHighlighter":[31446],"./unicodeTextModelHighlighter.js":[31446]};function d(c){if(!e.o(o,c))return Promise.resolve().then(function(){var g=new Error("Cannot find module '"+c+"'");throw g.code="MODULE_NOT_FOUND",g});var _=o[c],j=_[0];return Promise.all(_.slice(1).map(e.e)).then(function(){return e(j)})}d.keys=function(){return Object.keys(o)},d.id=10131,R.exports=d}}]);
