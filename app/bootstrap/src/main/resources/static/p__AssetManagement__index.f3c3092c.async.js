(self.webpackChunk=self.webpackChunk||[]).push([[3231],{8751:function(K,Z,t){"use strict";t.d(Z,{Z:function(){return c}});var S=t(87462),h=t(62435),p={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M699 353h-46.9c-10.2 0-19.9 4.9-25.9 13.3L469 584.3l-71.2-98.8c-6-8.3-15.6-13.3-25.9-13.3H325c-6.5 0-10.3 7.4-6.5 12.7l124.6 172.8a31.8 31.8 0 0051.7 0l210.6-292c3.9-5.3.1-12.7-6.4-12.7z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"check-circle",theme:"outlined"},W=p,I=t(84089),E=function(T,D){return h.createElement(I.Z,(0,S.Z)({},T,{ref:D,icon:W}))},_=h.forwardRef(E),c=_},18429:function(K,Z,t){"use strict";t.d(Z,{Z:function(){return c}});var S=t(87462),h=t(62435),p={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64c247.4 0 448 200.6 448 448S759.4 960 512 960 64 759.4 64 512 264.6 64 512 64zm0 76c-205.4 0-372 166.6-372 372s166.6 372 372 372 372-166.6 372-372-166.6-372-372-372zm128.01 198.83c.03 0 .05.01.09.06l45.02 45.01a.2.2 0 01.05.09.12.12 0 010 .07c0 .02-.01.04-.05.08L557.25 512l127.87 127.86a.27.27 0 01.05.06v.02a.12.12 0 010 .07c0 .03-.01.05-.05.09l-45.02 45.02a.2.2 0 01-.09.05.12.12 0 01-.07 0c-.02 0-.04-.01-.08-.05L512 557.25 384.14 685.12c-.04.04-.06.05-.08.05a.12.12 0 01-.07 0c-.03 0-.05-.01-.09-.05l-45.02-45.02a.2.2 0 01-.05-.09.12.12 0 010-.07c0-.02.01-.04.06-.08L466.75 512 338.88 384.14a.27.27 0 01-.05-.06l-.01-.02a.12.12 0 010-.07c0-.03.01-.05.05-.09l45.02-45.02a.2.2 0 01.09-.05.12.12 0 01.07 0c.02 0 .04.01.08.06L512 466.75l127.86-127.86c.04-.05.06-.06.08-.06a.12.12 0 01.07 0z"}}]},name:"close-circle",theme:"outlined"},W=p,I=t(84089),E=function(T,D){return h.createElement(I.Z,(0,S.Z)({},T,{ref:D,icon:W}))},_=h.forwardRef(E),c=_},56477:function(K,Z,t){"use strict";t.d(Z,{Z:function(){return c}});var S=t(87462),h=t(62435),p={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M690 405h-46.9c-10.2 0-19.9 4.9-25.9 13.2L512 563.6 406.8 418.2c-6-8.3-15.6-13.2-25.9-13.2H334c-6.5 0-10.3 7.4-6.5 12.7l178 246c3.2 4.4 9.7 4.4 12.9 0l178-246c3.9-5.3.1-12.7-6.4-12.7z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"down-circle",theme:"outlined"},W=p,I=t(84089),E=function(T,D){return h.createElement(I.Z,(0,S.Z)({},T,{ref:D,icon:W}))},_=h.forwardRef(E),c=_},61011:function(K,Z,t){"use strict";t.d(Z,{Z:function(){return c}});var S=t(87462),h=t(62435),p={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M666.7 505.5l-246-178A8 8 0 00408 334v46.9c0 10.2 4.9 19.9 13.2 25.9L566.6 512 421.2 617.2c-8.3 6-13.2 15.6-13.2 25.9V690c0 6.5 7.4 10.3 12.7 6.5l246-178c4.4-3.2 4.4-9.8 0-13z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"right-circle",theme:"outlined"},W=p,I=t(84089),E=function(T,D){return h.createElement(I.Z,(0,S.Z)({},T,{ref:D,icon:W}))},_=h.forwardRef(E),c=_},28058:function(K,Z,t){"use strict";t.d(Z,{Z:function(){return c}});var S=t(87462),h=t(62435),p={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M464 720a48 48 0 1096 0 48 48 0 10-96 0zm16-304v184c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V416c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8zm475.7 440l-416-720c-6.2-10.7-16.9-16-27.7-16s-21.6 5.3-27.7 16l-416 720C56 877.4 71.4 904 96 904h832c24.6 0 40-26.6 27.7-48zm-783.5-27.9L512 239.9l339.8 588.2H172.2z"}}]},name:"warning",theme:"outlined"},W=p,I=t(84089),E=function(T,D){return h.createElement(I.Z,(0,S.Z)({},T,{ref:D,icon:W}))},_=h.forwardRef(E),c=_},3859:function(K,Z,t){"use strict";var S=t(97857),h=t.n(S),p=t(66309),W=t(62435),I=t(53846),E=t(86074);Z.Z=function(_){var c,z=_.text,T=_.style,D=_.level;return(0,E.jsx)(p.Z,{className:I.Z[D==="HIGH"?"riskHigh":(c=["MEDIUM","MIDDLE"])!==null&&c!==void 0&&c.includes(D)?"riskMedium":D==="LOW"?"riskLow":""],style:h()({},T),children:z})}},31732:function(K,Z,t){"use strict";var S=t(97857),h=t.n(S),p=t(66309),W=t(62435),I=t(86074);Z.Z=function(E){var _=E.text,c=E.style;return(0,I.jsx)(p.Z,{style:h()({background:"#ebf0ff",border:"1px solid #a6bfff",borderRadius:2,color:"#457aff"},c),children:_})}},92834:function(K,Z,t){"use strict";t.r(Z),t.d(Z,{default:function(){return ft}});var S=t(15009),h=t.n(S),p=t(99289),W=t.n(p),I=t(97857),E=t.n(I),_=t(5574),c=t.n(_),z=t(81569),T=t(3859),D=t(31732),Q=t(53846),_e=t(24163),de=t(21171),q=t(29448),be=t(45742),ce=t(93410),L=t(92016),Ie=t(25593),ye=t(85265),Pe=t(83062),Se=t(86250),Be=t(92398),y=t(62435),M=t(24732),Ee=t(29297),s=t(96486),e=t(86074),Ve=function(j){var r=j.assetInstanceVisible,f=j.assetInfo,x=j.setAssetInstanceVisible,g=(0,y.useState)(""),u=c()(g,2),m=u[0],B=u[1],N=(0,L.useIntl)(),te=function(){x(!1),B("")},P=function(){te()};return(0,y.useEffect)(function(){if(r&&!(0,s.isEmpty)(f)){var A=JSON.stringify(f==null?void 0:f.instance,null,4);(0,s.isEmpty)(A)||B(A)}},[r]),(0,e.jsx)(ye.Z,{title:N.formatMessage({id:"asset.extend.text.detail"}),width:"42%",destroyOnClose:!0,open:r,onClose:P,children:!(0,s.isEmpty)(m)&&(0,e.jsx)(Ee.q9,{editorKey:"assetInstance",value:m,readOnly:!0,editorStyle:{height:"100%"}})})},at=Ve,me=t(92086),re=t(96364),De=t(72028),ee=t(17910),ve=t(70989),ie=t(66309),J=t(83622),Ce=function(j){var r=j.assetInfo,f=(0,y.useRef)(),x=(0,y.useRef)(),g=(0,y.useState)(!1),u=c()(g,2),m=u[0],B=u[1],N=(0,y.useRef)({}),te=[{title:"\u8D44\u6E90\u540D\u79F0",dataIndex:"resourceName",valueType:"text",align:"center",render:function(A,i){return(0,e.jsx)(_e.Z,{text:i!=null&&i.resourceExist?i.resourceName:"(\u4E0D\u5B58\u5728) "+i.resourceName,maxWidth:280})}},{title:"\u8D44\u6E90\u7C7B\u578B",dataIndex:"resourceType",valueType:"text",align:"center",render:function(A,i){return(0,e.jsx)(ie.Z,{color:"geekblue",children:i==null?void 0:i.resourceType})}},{title:"\u89C4\u5219\u540D\u79F0",dataIndex:"ruleName",valueType:"text",align:"center",render:function(A,i){var o;return(0,e.jsx)("span",{children:i==null||(o=i.ruleVO)===null||o===void 0?void 0:o.ruleName})}},{title:"\u89C4\u5219\u7EC4",dataIndex:"groupName",valueType:"text",align:"center",render:function(A,i){var o;return(0,e.jsx)("span",{children:i==null||(o=i.ruleVO)===null||o===void 0?void 0:o.groupName})}},{title:"\u98CE\u9669\u7B49\u7EA7",dataIndex:"riskLevel",valueType:"text",align:"center",render:function(A,i){var o=ee.I9===null||ee.I9===void 0?void 0:ee.I9.find(function(v){var U;return v.value===(i==null||(U=i.ruleVO)===null||U===void 0?void 0:U.riskLevel)});return(0,e.jsx)(ie.Z,{color:o==null?void 0:o.color,children:(o==null?void 0:o.text)||"-"})}},{title:"\u98CE\u9669\u72B6\u6001",dataIndex:"status",valueType:"text",align:"center",render:function(A,i){var o=re.MW===null||re.MW===void 0?void 0:re.MW.find(function(v){return v.value===(i==null?void 0:i.status)});return(0,e.jsx)(ie.Z,{color:o==null?void 0:o.color,children:(o==null?void 0:o.label)||"-"})}},{title:"\u6700\u8FD1\u626B\u63CF\u547D\u4E2D",dataIndex:"gmtModified",valueType:"text",align:"center"},{title:"\u64CD\u4F5C",dataIndex:"option",valueType:"option",align:"center",render:function(A,i){return(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(J.ZP,{type:"link",onClick:function(){N.current=E()({},i),B(!0)},children:"\u8BE6\u60C5"})})}}];return(0,e.jsxs)(ce.Z,{boxShadow:!0,bodyStyle:{padding:"32px 4px 12px 4px"},children:[(0,e.jsx)(ve.Z,{tableStyle:{padding:0},scroll:{x:"max-content"},rowKey:"id",search:!1,options:!1,actionRef:f,formRef:x,columns:te,request:function(){var P=W()(h()().mark(function A(i){var o,v,U,le,O,d,ue,$,ge;return h()().wrap(function(se){for(;;)switch(se.prev=se.next){case 0:return o=i.pageSize,v=i.current,U=i.cloudAccountId,le=i.resourceId,O=i.platform,d={page:v,size:o,cloudAccountId:U,resourceId:le,platformList:[O]},se.next=4,(0,De.queryRiskList)(d);case 4:return ue=se.sent,$=ue.content,ge=ue.code,se.abrupt("return",{data:($==null?void 0:$.data)||[],total:($==null?void 0:$.total)||0,success:ge===200||!1});case 8:case"end":return se.stop()}},A)}));return function(A){return P.apply(this,arguments)}}(),params:E()({},r),pagination:{showQuickJumper:!1,showSizeChanger:!0,defaultPageSize:10,defaultCurrent:1,showTotal:function(A){return"\u5171 ".concat(A," \u6761")}}}),(0,e.jsx)(me.Z,{locate:"asset",riskDrawerVisible:m,setRiskDrawerVisible:B,riskDrawerInfo:N.current,tableActionRef:f})]})},X=Ce,fe=t(32983),k=t(23323),Ae=Ie.Z.Text,We=function(j){var r=(0,L.useAccess)(),f=r.isAdmin,x=j.assetInfo;return(0,e.jsx)("div",{children:f?(0,e.jsx)(J.ZP,{type:"link",size:"small",href:"/assetManagement/asseConfig?id=".concat(x==null?void 0:x.id),target:"_blank",children:"\u914D\u7F6E\u8BE6\u60C5"}):(0,e.jsx)(e.Fragment,{})})},Fe=function(j){var r,f,x,g,u=j.assetInfo;return(0,e.jsx)(ce.Z,{boxShadow:!0,extra:(0,e.jsx)(We,{assetInfo:u}),bodyStyle:{paddingBlockStart:0},children:(0,s.isEmpty)(u==null||(r=u.resourceDetailConfigMap)===null||r===void 0?void 0:r.BASE_INFO)&&(0,s.isEmpty)(u==null||(f=u.resourceDetailConfigMap)===null||f===void 0?void 0:f.NETWORK)?(0,e.jsx)(fe.Z,{image:fe.Z.PRESENTED_IMAGE_SIMPLE}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Ae,{style:{marginBottom:6,display:"block",color:"#377df7"},children:"\u57FA\u672C\u4FE1\u606F:"}),u==null||(x=u.resourceDetailConfigMap)===null||x===void 0||(x=x.BASE_INFO)===null||x===void 0?void 0:x.map(function(m,B){return(0,e.jsx)(k.Z.Item,{label:m==null?void 0:m.name,children:m.value},B)}),(0,e.jsx)(Ae,{style:{marginBottom:6,display:"block",color:"#377df7"},children:"\u7F51\u7EDC\u4FE1\u606F:"}),u==null||(g=u.resourceDetailConfigMap)===null||g===void 0||(g=g.NETWORK)===null||g===void 0?void 0:g.map(function(m,B){return(0,e.jsx)(k.Z.Item,{label:m==null?void 0:m.name,children:m.value},B)})]})})},Me=Fe,w=Ie.Z.Text,ke=function(j){var r,f=j.assetDrawerVisible,x=j.assetDrawerInfo,g=j.setAssetDrawerVisible,u=(0,L.useModel)("rule"),m=u.platformList,B=(0,L.useModel)("asset"),N=B.assetList,te=(0,y.useState)(!1),P=c()(te,2),A=P[0],i=P[1],o=(0,L.useRequest)(function(ne){return(0,de.queryResourceDetailById)({id:ne})},{manual:!0,formatResult:function(he){return he.content||{}}}),v=o.data,U=o.run,le=o.loading,O=(0,y.useState)("BasicAsset"),d=c()(O,2),ue=d[0],$=d[1],ge=[{key:"BasicAsset",label:"\u8D44\u4EA7\u4FE1\u606F",children:(0,e.jsx)(Me,{assetInfo:v})},{key:"AssociateRisk",label:"\u98CE\u9669\u4FE1\u606F",children:(0,e.jsx)(X,{assetInfo:v})}],Te=function(he){$(he)},se=function(){g(!1),$("BasicAsset")},Le=function(){se()};return(0,y.useEffect)(function(){f&&x!==null&&x!==void 0&&x.id&&U(x.id)},[f,x]),(0,e.jsxs)(ye.Z,{title:"\u8D44\u4EA7\u8BE6\u60C5",width:"50%",open:f,onClose:Le,loading:le,children:[(0,e.jsxs)(ce.Z,{boxShadow:!0,style:{marginBottom:16},bodyStyle:{paddingBlock:6},children:[(0,e.jsxs)(w,{className:M.Z.customText,children:["\u8D44\u6E90\u540D\u79F0: ",(v==null?void 0:v.resourceName)||"-"]}),(0,e.jsxs)(w,{className:M.Z.customText,children:["\u8D44\u6E90id: ",(v==null?void 0:v.resourceId)||"-",(0,e.jsx)(Pe.Z,{title:"\u8D44\u6E90\u8BE6\u60C5",children:(0,e.jsx)("span",{className:M.Z.iconWrap,onClick:function(){return i(!0)},children:(0,e.jsx)(be.Z,{className:M.Z.resourceInstance})})})]}),(0,e.jsx)(w,{className:M.Z.customText,children:(0,e.jsxs)(Se.Z,{children:["\u4E91\u670D\u52A1:",(0,e.jsx)("span",{style:{margin:"0 12px 0 6px"},children:(0,q.fD)(v==null?void 0:v.platform,m)}),(0,e.jsx)("span",{children:v==null?void 0:v.platform})]})}),(0,e.jsxs)(w,{className:M.Z.customText,children:["\u8D44\u6E90\u7C7B\u578B:",(0,e.jsx)("span",{style:{color:"#0958d9",marginLeft:"4px"},children:(N==null||(r=N.find(function(ne){return ne.value===(v==null?void 0:v.resourceType)}))===null||r===void 0?void 0:r.label)||"-"})]})]}),(0,e.jsx)(Be.Z,{activeKey:ue,items:ge,onChange:Te,destroyInactiveTabPane:!0}),(0,e.jsx)(at,{assetInstanceVisible:A,setAssetInstanceVisible:i,assetInfo:v})]})},Oe=ke,Ne=function(j){var r=j.assetInformVisible,f=j.assetInfo,x=j.setAssetInformVisible,g=(0,y.useState)(""),u=c()(g,2),m=u[0],B=u[1],N=(0,L.useIntl)(),te=function(){x(!1)},P=(0,L.useRequest)(function(o){return(0,de.queryResourceDetailById)({id:o})},{manual:!0,formatResult:function(v){var U=v.content,le=JSON.stringify(U==null?void 0:U.instance,null,4);(0,s.isEmpty)(le)||B(le)}}),A=P.run,i=P.loading;return(0,y.useEffect)(function(){r&&f!==null&&f!==void 0&&f.id&&A(Number(f.id))},[r,f]),(0,e.jsx)(ye.Z,{title:N.formatMessage({id:"asset.extend.text.detail"}),width:"46%",open:r,onClose:te,destroyOnClose:!0,loading:i,children:m&&(0,e.jsx)(Ee.q9,{editorKey:"ASSET_CONFIG_INSTANCE",value:m,readOnly:!0,editorStyle:{height:"100%"}})})},Ke=Ne,we=t(96987),je=t(92635),Ue=t(79930),Ze=t(86548),ze=t(39380),Re=t(42075),l=t(3303),xe=t(71230),b=t(15746),$e=t(84567),Y=t(34041),He=t(57381),lt=t(25278),dt=t(21532),ct=Ie.Z.Paragraph,mt=function(j){var r=j.record,f=(0,L.useIntl)(),x=(0,L.useRequest)(function(m){return(0,de.queryResourceRiskQuantity)({idList:[m]})},{manual:!0,formatResult:function(B){return B.content[0]}}),g=x.data,u=x.run;return(0,y.useEffect)(function(){r!=null&&r.id&&u(Number(r.id))},[r]),(0,e.jsxs)(Re.Z,{size:2,children:[(0,e.jsx)(J.ZP,{type:"link",style:{padding:0},size:"small",target:"_blank",href:"/riskManagement/riskList?platform=".concat(r==null?void 0:r.platform,"&riskLevel=").concat(ee.I9[0].value,"&resourceId=").concat(r==null?void 0:r.resourceId),rel:"prefetch",children:(0,e.jsx)(T.Z,{level:"HIGH",text:"".concat(f.formatMessage({id:"common.link.text.high"})," ").concat((g==null?void 0:g.highLevelRiskCount)||0)})}),(0,e.jsx)(J.ZP,{type:"link",style:{padding:0},size:"small",target:"_blank",href:"/riskManagement/riskList?platform=".concat(r==null?void 0:r.platform,"&riskLevel=").concat(ee.I9[1].value,"&resourceId=").concat(r==null?void 0:r.resourceId),rel:"prefetch",children:(0,e.jsx)(T.Z,{level:"MEDIUM",text:"".concat(f.formatMessage({id:"common.link.text.middle"})," ").concat((g==null?void 0:g.mediumLevelRiskCount)||0)})}),(0,e.jsx)(J.ZP,{type:"link",style:{padding:0},size:"small",target:"_blank",href:"/riskManagement/riskList?platform=".concat(r==null?void 0:r.platform,"&riskLevel=").concat(ee.I9[2].value,"&resourceId=").concat(r==null?void 0:r.resourceId),rel:"prefetch",children:(0,e.jsx)(T.Z,{level:"LOW",text:"".concat(f.formatMessage({id:"common.link.text.low"}),"  ").concat((g==null?void 0:g.lowLevelRiskCount)||0)})})]})},vt=function(){var j,r=l.Z.SHOW_CHILD,f=(0,L.useModel)("rule"),x=f.platformList,g=new URLSearchParams((j=(0,L.useLocation)())===null||j===void 0?void 0:j.search),u=g.get("cloudAccountId"),m=g.get("platform"),B=g.get("resourceGroupType"),N=g.get("resourceType"),te=(0,y.useRef)(),P=(0,y.useRef)(),A=(0,y.useState)(!1),i=c()(A,2),o=i[0],v=i[1],U=k.Z.useForm(),le=c()(U,1),O=le[0],d=(0,L.useIntl)(),ue=(0,y.useState)(!1),$=c()(ue,2),ge=$[0],Te=$[1],se=(0,y.useRef)({}),Le=(0,y.useRef)({}),ne=(0,y.useState)([]),he=c()(ne,2),xt=he[0],Ge=he[1],gt=(0,y.useState)({customField:{show:!1},cloudAccountId:{show:!1},platform:{show:!1},address:{show:!1},tenantName:{show:!1}}),ht=c()(gt,1),pt=ht[0],It=(0,L.useRequest)(function(C){return(0,Ue.queryGroupTypeList)({platformList:C})},{manual:!0,formatResult:function(a){var n=a.content;Ge(n||[])}}),rt=It.run,yt=[{title:(0,e.jsxs)(e.Fragment,{children:[d.formatMessage({id:"common.table.columns.assetId"}),"\xA0\xA0|\xA0\xA0",d.formatMessage({id:"common.table.columns.assetName"})]}),dataIndex:"resourceId",valueType:"text",align:"left",hideInSearch:!0,render:function(a,n){return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(J.ZP,{style:{padding:0},size:"small",type:"link",onClick:function(){Le.current=E()({},n),v(!0)},children:(0,e.jsx)(ct,{copyable:!0,style:{color:"inherit",marginBottom:0},children:n.resourceId})}),(0,e.jsx)(_e.Z,{placement:"topLeft",text:n.resourceName,maxWidth:360,style:{color:"#333"}})]})}},{title:d.formatMessage({id:"cloudAccount.extend.title.asset.type"}),dataIndex:"resourceType",valueType:"text",align:"left",width:200,hideInSearch:!0,render:function(a,n){return(0,e.jsx)(D.Z,{text:n==null?void 0:n.resourceType})}},{title:d.formatMessage({id:"asset.module.risk.number"}),width:200,dataIndex:"rulePassRate",valueType:"text",align:"left",hideInSearch:!0,render:function(a,n){return(0,e.jsx)(mt,{record:n})}},{title:d.formatMessage({id:"common.input.text.custom.fields"}),dataIndex:"customFieldValue",valueType:"text",align:"left",render:function(a,n){var H,G,F,V;return(0,e.jsx)(xe.Z,{children:(0,e.jsx)(b.Z,{span:24,children:(0,s.isEmpty)(n==null||(H=n.resourceDetailConfigMap)===null||H===void 0?void 0:H.BASE_INFO)&&(0,s.isEmpty)(n==null||(G=n.resourceDetailConfigMap)===null||G===void 0?void 0:G.NETWORK)?"-":(0,e.jsxs)(e.Fragment,{children:[n==null||(F=n.resourceDetailConfigMap)===null||F===void 0||(F=F.BASE_INFO)===null||F===void 0?void 0:F.map(function(R,ae){return(0,e.jsx)(k.Z.Item,{label:R==null?void 0:R.name,style:{marginBottom:0,color:"#333"},children:R.value},ae)}),n==null||(V=n.resourceDetailConfigMap)===null||V===void 0||(V=V.NETWORK)===null||V===void 0?void 0:V.map(function(R,ae){return(0,e.jsx)(k.Z.Item,{label:R==null?void 0:R.name,style:{marginBottom:0,color:"#333"},children:R.value},ae)})]})})})}},{title:d.formatMessage({id:"common.table.columns.createAndUpdateTime"}),dataIndex:"gmt_modified",tooltip:d.formatMessage({id:"common.table.columns.sort.update"}),valueType:"text",align:"left",hideInSearch:!0,sorter:!0,width:240,render:function(a,n){return(0,e.jsxs)("div",{children:[(0,e.jsx)("section",{style:{color:"#999"},children:(n==null?void 0:n.gmtCreate)||"-"}),(0,e.jsx)("section",{style:{color:"#999"},children:(n==null?void 0:n.gmtModified)||"-"})]})}},{title:d.formatMessage({id:"common.select.label.cloudAccount"}),dataIndex:"cloudAccountId",valueType:"text",align:"left",hideInSearch:!0,render:function(a,n){return(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{children:n==null?void 0:n.cloudAccountId}),(0,e.jsx)("div",{style:{color:"#999"},children:n==null?void 0:n.alias})]})}},{title:d.formatMessage({id:"common.select.label.cloudPlatform"}),dataIndex:"platform",valueType:"text",align:"center",hideInSearch:!0,render:function(a,n){return(0,q.fD)(n.platform,x)}},{title:d.formatMessage({id:"asset.module.input.text.ip"}),dataIndex:"address",valueType:"text",align:"left",hideInSearch:!0},{title:d.formatMessage({id:"common.select.label.tenant"}),dataIndex:"tenantName",valueType:"text",align:"left",hideInSearch:!0}],Qe=(0,L.useRequest)(function(C){return(0,je.cloudAccountBaseInfoList)(E()({},C))},{manual:!0,formatResult:function(a){if(a.msg==="success"){var n;return(a==null||(n=a.content)===null||n===void 0||(n=n.accountAliasList)===null||n===void 0?void 0:n.map(function(H){return{label:H,value:H}}))||[]}}}),Et=Qe.data,Je=Qe.run,Dt=Qe.loading,Ct=(0,y.useMemo)(function(){var C=function(n){Je({platformList:O.getFieldValue("platformList")||[],cloudAccountSearch:n})};return(0,s.debounce)(C,500)},[je.cloudAccountBaseInfoList]);return(0,y.useEffect)(function(){var C={};if(m&&(C.platformList=[m]),u&&(C.cloudAccountSearch=u),Je(C),(!(0,s.isEmpty)(u)||!(0,s.isEmpty)(m)||!(0,s.isEmpty)(B)&&!(0,s.isEmpty)(N))&&(u&&(O==null||O.setFieldValue("cloudAccountId",u)),!(0,s.isEmpty)(m)&&(O==null||O.setFieldValue("platformList",[m]),O.setFieldValue("resourceTypeList",null),Ge([]),rt([m]),!(0,s.isEmpty)(B)&&!(0,s.isEmpty)(N)))){var a=[],n=[B,N];a.push(n),O.setFieldValue("resourceTypeList",a)}},[m,u,N]),(0,e.jsxs)(ze._z,{title:!1,className:M.Z.assetPageContainer,breadcrumb:void 0,children:[(0,e.jsx)(ce.Z,{bodyStyle:{paddingBottom:0},className:M.Z.customFilterCard,children:(0,e.jsx)(k.Z,{form:O,children:(0,e.jsxs)(xe.Z,{gutter:[24,10],children:[(0,e.jsx)(b.Z,{span:24,children:(0,e.jsx)(k.Z.Item,{name:"platformList",label:d.formatMessage({id:"common.select.label.cloudPlatform"}),style:{marginBottom:0},children:(0,e.jsx)($e.Z.Group,{options:(0,q.T$)(x),onChange:function(a){O.setFieldValue("resourceTypeList",null),Ge([]),rt(a),Je({platformList:a||[]})}})})}),(0,e.jsx)(b.Z,{span:6,children:(0,e.jsx)(k.Z.Item,{name:"resourceTypeList",label:d.formatMessage({id:"cloudAccount.extend.title.asset.type"}),style:{marginBottom:0,width:"100%"},children:(0,e.jsx)(l.Z,{options:xt,multiple:!0,placeholder:d.formatMessage({id:"common.select.text.placeholder"}),showCheckedStrategy:r,allowClear:!0,showSearch:!0})})}),(0,e.jsx)(b.Z,{span:6,children:(0,e.jsx)(k.Z.Item,{name:"cloudAccountId",label:d.formatMessage({id:"common.select.label.cloudAccount"}),style:{marginBottom:0,width:"100%"},children:(0,e.jsx)(Y.Z,{allowClear:!0,showSearch:!0,placeholder:d.formatMessage({id:"common.select.query.text.placeholder"}),notFoundContent:Dt&&(0,e.jsx)(He.Z,{size:"small"}),onSearch:Ct,options:Et||[]})})}),(0,e.jsx)(b.Z,{span:6,children:(0,e.jsx)(k.Z.Item,{name:"searchParam",label:d.formatMessage({id:"common.input.text.assetIdAndName"}),style:{marginBottom:0,width:"100%"},children:(0,e.jsx)(lt.Z,{placeholder:d.formatMessage({id:"common.input.text.placeholder"}),allowClear:!0})})}),(0,e.jsx)(b.Z,{span:6,children:(0,e.jsx)(k.Z.Item,{name:"address",label:d.formatMessage({id:"asset.module.input.text.ip"}),style:{marginBottom:0,width:"100%"},children:(0,e.jsx)(lt.Z,{placeholder:d.formatMessage({id:"common.input.text.placeholder"}),allowClear:!0})})})]})})}),(0,e.jsx)(ve.Z,{scroll:{x:"max-content"},rowKey:"id",search:{span:6,labelWidth:0},headerTitle:(0,e.jsx)("div",{className:Q.Z.customTitle,children:d.formatMessage({id:"asset.module.text.asset.inquiry"})}),actionRef:te,formRef:P,columns:yt,columnsState:{defaultValue:pt,persistenceType:"localStorage",persistenceKey:"ASSET_TABLE_LIST_CACHE"},onReset:function(){var a;O.resetFields(),(a=P.current)===null||a===void 0||a.resetFields()},pagination:{showQuickJumper:!1,showSizeChanger:!0,defaultPageSize:10,defaultCurrent:1,pageSizeOptions:[10,20,50]},request:function(){var C=W()(h()().mark(function a(n,H){var G,F,V,R,ae,Xe,Ye,qe,et,tt,st,nt,it,ot,ut;return h()().wrap(function(pe){for(;;)switch(pe.prev=pe.next){case 0:return G=n.customFieldValue,F=n.current,V=n.pageSize,R={customFieldValue:G,page:F,size:V},ae=(0,q.Hm)(H),(0,s.isEmpty)(ae)||(R.sortParam=ae==null?void 0:ae.key,R.sortType=we.ym[ae.value]),Xe=O.getFieldValue("platformList"),(0,s.isEmpty)(Xe)||(R.platformList=Xe),Ye=O.getFieldValue("resourceTypeList"),(0,s.isEmpty)(Ye)||(R.resourceTypeList=Ye),qe=O.getFieldValue("cloudAccountId"),(0,s.isEmpty)(qe)||(R.cloudAccountId=qe),et=O.getFieldValue("searchParam"),et&&(R.searchParam=et),tt=O.getFieldValue("address"),tt&&(R.address=tt),pe.next=16,(0,de.queryResourceList)(R);case 16:return st=pe.sent,nt=st.content,it=st.code,ot=nt.data,ut=nt.total,pe.abrupt("return",{data:ot||[],total:ut||0,success:it===200||!1});case 21:case"end":return pe.stop()}},a)}));return function(a,n){return C.apply(this,arguments)}}(),tableClassName:M.Z.customAssetTable,expandable:{expandedRowRender:function(a){var n,H,G,F;return(0,e.jsxs)(xe.Z,{children:[(0,e.jsx)(b.Z,{span:2,className:M.Z.dimBlock,style:{borderLeft:"0.5px solid rgb(239, 239, 239)"},children:d.formatMessage({id:"common.select.label.cloudAccount"})}),(0,e.jsxs)(b.Z,{span:4,className:M.Z.cleanBlock,style:{flexDirection:"column"},children:[(0,e.jsx)("div",{children:a==null?void 0:a.cloudAccountId}),(0,e.jsx)("div",{style:{color:"#999"},children:a==null?void 0:a.alias})]}),(0,e.jsx)(b.Z,{span:2,className:M.Z.dimBlock,children:d.formatMessage({id:"common.select.label.cloudPlatform"})}),(0,e.jsx)(b.Z,{span:4,className:M.Z.cleanBlock,children:(0,q.fD)(a.platform,x)}),(0,e.jsx)(b.Z,{span:2,className:M.Z.dimBlock,children:d.formatMessage({id:"asset.module.input.text.ip"})}),(0,e.jsx)(b.Z,{span:4,className:M.Z.cleanBlock,children:(a==null?void 0:a.address)||"-"}),(0,e.jsx)(b.Z,{span:2,className:M.Z.dimBlock,children:d.formatMessage({id:"common.select.label.tenant"})}),(0,e.jsx)(b.Z,{span:4,className:M.Z.cleanBlock,children:(a==null?void 0:a.tenantName)||"-"}),(0,e.jsx)(b.Z,{span:2,className:M.Z.dimBlock,style:{borderTop:"none",borderLeft:"0.5px solid rgb(239, 239, 239)"},children:d.formatMessage({id:"common.input.text.custom.fields"})}),(0,e.jsx)(b.Z,{span:22,className:M.Z.customField,style:{borderTop:"none"},children:(0,e.jsxs)(xe.Z,{children:[(0,e.jsx)(b.Z,{span:22,children:(0,s.isEmpty)(a==null||(n=a.resourceDetailConfigMap)===null||n===void 0?void 0:n.BASE_INFO)&&(0,s.isEmpty)(a==null||(H=a.resourceDetailConfigMap)===null||H===void 0?void 0:H.NETWORK)?(0,e.jsx)(dt.ZP,{theme:{token:{margin:8,marginXL:8,marginXS:8}},children:(0,e.jsx)(fe.Z,{image:fe.Z.PRESENTED_IMAGE_SIMPLE})}):(0,e.jsxs)(e.Fragment,{children:[a==null||(G=a.resourceDetailConfigMap)===null||G===void 0||(G=G.BASE_INFO)===null||G===void 0?void 0:G.map(function(V,R){return(0,e.jsx)(k.Z.Item,{label:V==null?void 0:V.name,style:{marginBottom:0,color:"#333"},children:V.value},R)}),a==null||(F=a.resourceDetailConfigMap)===null||F===void 0||(F=F.NETWORK)===null||F===void 0?void 0:F.map(function(V,R){return(0,e.jsx)(k.Z.Item,{label:V==null?void 0:V.name,style:{marginBottom:0,color:"#333"},children:V.value},R)})]})}),(0,e.jsx)(b.Z,{span:2,children:(0,e.jsxs)(J.ZP,{size:"small",type:"link",target:"_self",href:"/assetManagement/asseConfig?id=".concat(a==null?void 0:a.id),children:[(0,e.jsx)(Ze.Z,{}),d.formatMessage({id:"common.button.text.edit"})]})})]})})]})},columnTitle:(0,e.jsx)("div",{style:{width:30,textAlign:"center"}}),columnWidth:30,rowExpandable:function(){return!0},expandIcon:z.Z}}),(0,e.jsx)(Oe,{assetDrawerVisible:ge,setAssetDrawerVisible:Te,assetDrawerInfo:se.current,tableActionRef:te}),(0,e.jsx)(Ke,{assetInformVisible:o,setAssetInformVisible:v,assetInfo:Le.current})]})},ft=vt},92086:function(K,Z,t){"use strict";var S=t(5574),h=t.n(S),p=t(87426),W=t(39421),I=t(24163),E=t(71448),_=t(24482),c=t(50322),z=t(22145),T=t(96364),D=t(72028),Q=t(29448),_e=t(45742),de=t(93410),q=t(92016),be=t(25593),ce=t(85265),L=t(86250),Ie=t(83622),ye=t(42075),Pe=t(66309),Se=t(83062),Be=t(21532),y=t(23323),M=t(62435),Ee=t(47908),s=t(86074),e=be.Z.Text,Ve=function(me){var re,De,ee,ve,ie,J,Ce=me.riskDrawerVisible,X=me.riskDrawerInfo,fe=me.setRiskDrawerVisible,k=me.locate,Ae=(0,q.useModel)("rule"),We=Ae.platformList,Fe=(0,q.useModel)("tenant"),Me=Fe.tenantListAll,w=(0,q.useIntl)(),ke=(0,M.useState)(!1),Oe=h()(ke,2),Ne=Oe[0],Ke=Oe[1],we=(0,M.useState)(!1),je=h()(we,2),Ue=je[0],Ze=je[1],ze=function(){fe(!1)},Re=(0,q.useRequest)(function(Y){return(0,D.queryRiskDetailById)({riskId:Y})},{manual:!0,formatResult:function(He){return He.content||{}}}),l=Re.data,xe=Re.run,b=Re.loading,$e=function(){ze()};return(0,M.useEffect)(function(){Ce&&X!==null&&X!==void 0&&X.id&&xe(X.id)},[Ce,X]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(ce.Z,{title:w.formatMessage({id:"risk.module.text.detail.info"}),width:"50%",open:Ce,onClose:$e,loading:b,children:[(0,s.jsxs)(de.Z,{style:{marginBottom:20},bodyStyle:{backgroundColor:"#f9f9f9",padding:"16px 20px"},children:[(0,s.jsx)(L.Z,{justify:"space-between",align:"center",style:{marginBottom:10},children:(0,s.jsxs)("span",{children:[(0,s.jsx)(e,{style:{marginRight:12},children:(0,s.jsx)(Ie.ZP,{type:"link",href:"/ruleManagement/ruleProject/edit?id=".concat(l==null?void 0:l.ruleId),target:"_blank",style:{padding:"4px 0 4px 4px",fontSize:"18px"},children:(l==null||(re=l.ruleVO)===null||re===void 0?void 0:re.ruleName)||"-"})}),(0,s.jsxs)(ye.Z,{children:[(0,s.jsx)("span",{children:(0,Q.Ff)(T.MW,l==null?void 0:l.status)}),(l==null?void 0:l.ignoreReasonType)&&(0,s.jsxs)("span",{children:[(0,s.jsxs)(e,{style:{marginRight:8,color:"rgba(127, 127, 127, 1)"},children:[w.formatMessage({id:"risk.module.text.ignore.type"}),"\xA0:\xA0"]}),(0,s.jsx)(Pe.Z,{color:"geekblue",children:((De=T.$G.find(function(Y){return Y.value===(l==null?void 0:l.ignoreReasonType)}))===null||De===void 0?void 0:De.label)||"-"})]}),(l==null?void 0:l.ignoreReason)&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(e,{style:{marginRight:8,color:"rgba(127, 127, 127, 1)"},children:[w.formatMessage({id:"risk.module.text.ignore.reason"}),"\xA0:\xA0"]}),(0,s.jsx)(I.Z,{rows:1,text:l==null?void 0:l.ignoreReason,maxWidth:64})]})]})]})}),(0,s.jsxs)(L.Z,{vertical:!0,gap:10,children:[(0,s.jsxs)(L.Z,{align:"center",children:[(0,s.jsx)("img",{src:W.Z,alt:"DISCOVER_ICON",style:{width:14,height:14}}),(0,s.jsxs)("span",{style:{color:"rgba(127, 127, 127, 1)",margin:"0 8px 0 6px"},children:[w.formatMessage({id:"risk.module.text.recently.scanned.hits"}),"\xA0:\xA0"]}),(0,s.jsx)("span",{style:{color:"rgba(51, 51, 51, 1)"},children:l==null?void 0:l.gmtModified})]}),(0,s.jsxs)(e,{children:[(0,s.jsx)("img",{src:p.Z,alt:"DISCOVER_ICON",style:{width:14,height:14}}),(0,s.jsxs)("span",{style:{color:"rgba(127, 127, 127, 1)",margin:"0 8px 0 6px"},children:[w.formatMessage({id:"risk.module.text.first.discovery.time"}),"\xA0:\xA0"]}),(0,s.jsx)("span",{style:{color:"rgba(51, 51, 51, 1)"},children:l==null?void 0:l.gmtCreate})]})]}),(0,s.jsxs)(L.Z,{justify:"start",align:"center",style:{margin:"10px 0 6px 0"},children:[(0,s.jsx)("span",{style:{marginRight:5,color:"rgba(127, 127, 127, 1)"},children:(0,Q.fD)(l==null?void 0:l.platform,We)}),(0,s.jsx)(e,{style:{marginRight:20,color:"rgba(127, 127, 127, 1)"},children:(l==null?void 0:l.resourceType)||"-"}),(0,s.jsxs)(L.Z,{align:"center",children:[(0,s.jsx)("span",{style:{marginRight:4,color:"rgba(127, 127, 127, 1)"},children:(l==null?void 0:l.resourceName)+" / "+(l==null?void 0:l.resourceId)}),k==="risk"&&(0,s.jsx)(Se.Z,{title:w.formatMessage({id:"asset.extend.text.detail"}),children:(0,s.jsx)("span",{className:Ee.Z.iconWrap,onClick:function(){return Ze(!0)},children:(0,s.jsx)(_e.Z,{className:Ee.Z.resourceInstance})})})]}),(0,s.jsx)(e,{style:{color:"rgba(127, 127, 127, 1)",margin:"0 12px"},children:(Me==null||(ee=Me.find(function(Y){return Y.value===(l==null?void 0:l.tenantId)}))===null||ee===void 0?void 0:ee.label)||"-"})]})]}),(0,s.jsx)(Be.ZP,{theme:{components:{Form:{itemMarginBottom:8,labelColor:"rgba(127, 127, 127, 1)",labelColonMarginInlineEnd:16}}},children:(0,s.jsxs)(y.Z,{children:[(0,s.jsx)(y.Z.Item,{label:w.formatMessage({id:"rule.module.text.repair.suggestions"}),children:(0,s.jsx)("span",{style:{color:"rgb(51, 51, 51)"},children:(l==null||(ve=l.ruleVO)===null||ve===void 0?void 0:ve.advice)||"-"})}),(0,s.jsx)(y.Z.Item,{label:w.formatMessage({id:"risk.module.text.reference.link"}),children:(0,s.jsx)("span",{style:{color:"rgb(51, 51, 51)"},children:(l==null||(ie=l.ruleVO)===null||ie===void 0?void 0:ie.link)||"-"})}),(0,s.jsx)(y.Z.Item,{label:w.formatMessage({id:"rule.module.text.rule.describe"}),children:(0,s.jsx)("span",{style:{color:"rgb(51, 51, 51)"},children:(l==null||(J=l.ruleVO)===null||J===void 0?void 0:J.ruleDesc)||"-"})})]})}),(0,s.jsx)(E.Z,{riskDrawerInfo:X}),(0,s.jsx)(c.Z,{riskDrawerInfo:X})]}),(0,s.jsx)(_.Z,{evaluateDrawerVisible:Ne,setEvaluateDrawerVisible:Ke,riskDrawerInfo:X}),(0,s.jsx)(z.Z,{resourceDrawerVisible:Ue,setResourceDrawerVisible:Ze,riskDrawerInfo:X})]})};Z.Z=Ve},24732:function(K,Z){"use strict";Z.Z={polymerizeWrap:"polymerizeWrap___DA0Kx",polymerizeCard:"polymerizeCard___cqy_L",polymerizeHead:"polymerizeHead___wg2jK",polymerizeMain:"polymerizeMain___MABwi",riskWrap:"riskWrap___bmqQb",riskWrapLeft:"riskWrapLeft___IXwxM",riskWrapRight:"riskWrapRight___Kdvj4",riskAsset:"riskAsset___QyUxz",assetMain:"assetMain___cdM5B",newTag:"newTag___MqjNr",assetMainItem:"assetMainItem___m8m8F",assetMainItemLabel:"assetMainItemLabel___xE6cJ",assetView:"assetView____rh3f",assetPageContainer:"assetPageContainer___XCTom",customFilterCard:"customFilterCard___vdglF",customText:"customText___B_t7o",iconWrap:"iconWrap___tQQp4",resourceInstance:"resourceInstance___Y06OO",assetConfigPageContainer:"assetConfigPageContainer___tB7j6",customAssetTable:"customAssetTable___J9RJC",cleanBlock:"cleanBlock___xLiWM",dimBlock:"dimBlock___HBpS1",customField:"customField___J1Iyu",tabProCard:"tabProCard___ahTeu"}},64599:function(K,Z,t){var S=t(96263);function h(p,W){var I=typeof Symbol!="undefined"&&p[Symbol.iterator]||p["@@iterator"];if(!I){if(Array.isArray(p)||(I=S(p))||W&&p&&typeof p.length=="number"){I&&(p=I);var E=0,_=function(){};return{s:_,n:function(){return E>=p.length?{done:!0}:{done:!1,value:p[E++]}},e:function(Q){throw Q},f:_}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var c=!0,z=!1,T;return{s:function(){I=I.call(p)},n:function(){var Q=I.next();return c=Q.done,Q},e:function(Q){z=!0,T=Q},f:function(){try{!c&&I.return!=null&&I.return()}finally{if(z)throw T}}}}K.exports=h,K.exports.__esModule=!0,K.exports.default=K.exports}}]);
