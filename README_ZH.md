<div align="center">
  <h1>CloudRec â˜ï¸ğŸ›¡ï¸</h1>
  <p>
    <img src="https://img.shields.io/badge/License-Apache_2.0-blue?style=flat-square">
    <a href="doc.cloudrec.cloud"><img src="https://img.shields.io/badge/doc-English-blue?style=flat-square"></a>
    <a href="https://cloudrec.yuque.com/org-wiki-cloudrec-iew3sz/hocvhx"><img src="https://img.shields.io/badge/æ–‡æ¡£-ç®€ä½“ä¸­æ–‡-blue?style=flat-square"></a>
    <a href="https://discord.gg/WpWT9Q8BkD"><img src="https://img.shields.io/badge/Disord-Join_CloudRec-brightgreen?logo=discord&style=flat-square" /></a>
    <a href="https://discord.gg/WpWT9Q8BkD"><img src="https://img.shields.io/badge/DingTalk-Join_CloudRec-brightgreen?logo=data:image/svg+xml;base64,PHN2ZyB0PSIxNzQ3NzIxMzEzNDg4IiBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjcxMzgiIHdpZHRoPSIyMDAiIGhlaWdodD0iMjAwIj48cGF0aCBkPSJNOTA4LjQ3NCAzODEuOTJjLTEuNzY3IDcuNDctNi4xMjggMTguNDE5LTEyLjI0NiAzMS42MjRoMC4xMzJsLTAuNyAxLjIyM2MtMzUuNjk1IDc2LjQ5Mi0xMjguODk0IDIyNi41MTItMTI4Ljg5NCAyMjYuNTEycy0wLjExOS0wLjM1NC0wLjQ4Ni0wLjkzOGwtMjcuMjM1IDQ3LjQ4NWgxMzEuMjU0TDYxOS42MSAxMDIxLjcwNWw1Ni45MDMtMjI3LjEyOUg1NzMuMjM2bDM1Ljg4Ni0xNTAuMTljLTI5LjAzMyA3LjAxMS02My4zNSAxNi42NTQtMTAzLjk5MyAyOS43NCAwIDAtNTQuOTgyIDMyLjI0OS0xNTguMzgyLTYyLjAzNyAwIDAtNjkuNzM2LTYxLjUzMy0yOS4zMDQtNzYuOTA5IDE3LjE5Ni02LjUzOCA4My40OS0xNC44MzIgMTM1LjY0NS0yMS44OTQgNzAuNDg3LTkuNTQzIDExMy44NDgtMTQuNTk2IDExMy44NDgtMTQuNTk2cy0yMTcuMzE2IDMuMjU1LTI2OC44Ny00Ljg2NmMtNTEuNTU3LTguMTItMTE2Ljk1OS05NC4yNzUtMTMwLjg5LTE3MC4wMTkgMCAwLTIxLjU0Ny00MS41OCA0Ni4zMzQtMjEuODk0czM0OC44NTUgNzYuNjMyIDM0OC44NTUgNzYuNjMyLTM2NS40MjMtMTEyLjIwNC0zODkuNzQtMTM5LjU3OGMtMjQuMzEyLTI3LjM3NC03MS41NTctMTQ5LjQyMy02NS40MS0yMjQuNDIgMCAwIDIuNjY1LTE4LjY5OCAyMS44MDQtMTMuNjg3IDAgMCAyNzAuMTQ5IDEyMy42NCA0NTQuODc1IDE5MS4zMjMgMTg0LjcyNCA2Ny42ODMgMzQ1LjMzIDEwMi4xMDggMzI0LjU4IDE4OS43Mzl6IiBmaWxsPSIjMzI5NkZBIiBwLWlkPSI3MTM5Ij48L3BhdGg+PC9zdmc+Cg==&style=flat-square" /></a>
    <a href="https://demo.cloudrec.cloud"><img src="https://img.shields.io/badge/Demo-Try_CloudRec-orange?style=flat-square&logo=data:image/svg+xml;base64,PHN2ZyB0PSIxNzQ3NzIxNjg1MDQxIiBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjkxMzAiIHdpZHRoPSIyMDAiIGhlaWdodD0iMjAwIj48cGF0aCBkPSJNMjkwLjA5OTIgNDA5LjZIMTU1LjEzNmEzNzEuNDA0OCAzNzEuNDA0OCAwIDAgMC0xNC4yODQ4IDEwMi40YzAgMzUuNTMyOCA0Ljk2NjQgNjkuODg4IDE0LjMzNiAxMDIuNGgxMzQuOTYzMmMtNS42MzItMzIuNzY4LTguNDk5Mi02Ni45MTg0LTguNDk5Mi0xMDIuNCAwLTM1LjQ4MTYgMi44NjcyLTY5LjYzMiA4LjQ5OTItMTAyLjR6IG01Mi4wNzA0IDBhNTQyLjEwNTYgNTQyLjEwNTYgMCAwIDAtOS4zNjk2IDEwMi40YzAgMzUuNzM3NiAzLjA3MiA2OS44ODggOS4zNjk2IDEwMi40SDQ4Ni40VjQwOS42SDM0Mi4xNjk2eiBtNzUuMDA4IDQ2MS4zNjMyQTQ5MS44Nzg0IDQ5MS44Nzg0IDAgMCAxIDMwMS41NjggNjY1LjZIMTczLjk3NzZhMzcyLjA3MDQgMzcyLjA3MDQgMCAwIDAgMjQzLjIgMjA1LjM2MzJ6IG02OS4yMjI0LTMuNTg0VjY2NS42SDM1NC45Njk2YzI0LjA2NCA3Ny4xMDcyIDY3Ljg0IDE0NC4yMzA0IDEzMS40MzA0IDIwMS44MzA0ek00MTcuMTc3NiAxNTMuMDg4QTM3Mi4wNzA0IDM3Mi4wNzA0IDAgMCAwIDE3My45Nzc2IDM1OC40SDMwMS41NjhhNDkxLjg3ODQgNDkxLjg3ODQgMCAwIDEgMTE1LjU1ODQtMjA1LjM2MzJ6IG02OS4yMjI0IDMuNTg0QzQyMi44MDk2IDIxNC4xMTg0IDM3OS4wODQ4IDI4MS4yNDE2IDM1NC45Njk2IDM1OC40SDQ4Ni40VjE1Ni41Njk2ek03MzMuOTAwOCA0MDkuNmM1LjYzMiAzMi43NjggOC40OTkyIDY2LjkxODQgOC40OTkyIDEwMi40IDAgMzUuNDgxNi0yLjg2NzIgNjkuNjMyLTguNDk5MiAxMDIuNGgxMzUuMDE0NGM5LjMxODQtMzIuNTEyIDE0LjI4NDgtNjYuODY3MiAxNC4yODQ4LTEwMi40cy00Ljk2NjQtNjkuODg4LTE0LjMzNi0xMDIuNGgtMTM0Ljk2MzJ6IG0tNTIuMDcwNCAwSDUzNy42djIwNC44aDE0NC4yMzA0YzYuMjQ2NC0zMi41MTIgOS4zNjk2LTY2LjY2MjQgOS4zNjk2LTEwMi40cy0zLjA3Mi02OS44ODgtOS4zNjk2LTEwMi40eiBtLTc1LjAwOCA0NjEuMzYzMkEzNzIuMDcwNCAzNzIuMDcwNCAwIDAgMCA4NTAuMDIyNCA2NjUuNkg3MjIuNDMyYTQ5MS44Nzg0IDQ5MS44Nzg0IDAgMCAxLTExNS41NTg0IDIwNS4zNjMyeiBtLTY5LjIyMjQtMy41ODRjNjMuNTkwNC01Ny41NDg4IDEwNy4zMTUyLTEyNC42NzIgMTMxLjQzMDQtMjAxLjc3OTJINTM3LjZ2MjAxLjgzMDR6TTYwNi44MjI0IDE1My4wODhBNDkxLjg3ODQgNDkxLjg3ODQgMCAwIDEgNzIyLjQzMiAzNTguNGgxMjcuNjQxNmEzNzIuMDcwNCAzNzIuMDcwNCAwIDAgMC0yNDMuMi0yMDUuMzYzMnogbS02OS4yMjI0IDMuNTg0VjM1OC40aDEzMS40MzA0Yy0yNC4wNjQtNzcuMTA3Mi02Ny44NC0xNDQuMjMwNC0xMzEuNDMwNC0yMDEuODMwNHpNNTEyIDk0Ny4yYTQzNS4yIDQzNS4yIDAgMSAxIDAtODcwLjQgNDM1LjIgNDM1LjIgMCAwIDEgMCA4NzAuNHoiIGZpbGw9IiM1MmE4ZjkiIHAtaWQ9IjkxMzEiPjwvcGF0aD48L3N2Zz4K" /></a>
    </a>
  </p>
</div>

CloudRec æ˜¯ä¸€æ¬¾å¼€æºçš„å¤šäº‘å®‰å…¨æ€åŠ¿ç®¡ç†ï¼ˆCSPMï¼‰å¹³å°ï¼Œæ—¨åœ¨å¸®åŠ©ç»„ç»‡æå‡äº‘ç¯å¢ƒçš„å®‰å…¨æ€§ã€‚CloudRecæä¾›äº†å¼€æ”¾å¯æ‰©å±•çš„äº‘èµ„äº§é‡‡é›†æ¡†æ¶å’ŒåŸºäºOPAçš„è§„åˆ™ç®¡ç†å¼•æ“ï¼Œæ‚¨å¯ä»¥åŸºäºCloudRecè½»æ¾å®ç°ä¼ä¸šäº‘ç¯å¢ƒçš„å…¨é¢èµ„äº§é‡‡é›†ã€å®æ—¶å®‰å…¨å·¡æ£€ã€é£é™©äº‹ä»¶è¿è¥ã€‚

---

# å…³é”®ç‰¹æ€§

+ [ğŸ”—ä¸°å¯Œçš„å·¡æ£€è§„åˆ™](https://cloudrec.yuque.com/org-wiki-cloudrec-iew3sz/hocvhx/woi2erlkl5s4k4a1)ï¼šé™¤å†…ç½®çš„é«˜å±è§„åˆ™å¤–ï¼Œæä¾›äº†åŸºäºOPAçš„çµæ´»è§„åˆ™é…ç½®å¼•æ“ï¼Œä¸”æ”¯æŒå¤šä¸ªèµ„äº§å…³è”åˆ†æ
+ [ğŸ”—æ··åˆäº‘æ”¯æŒ](https://cloudrec.yuque.com/org-wiki-cloudrec-iew3sz/hocvhx/wx0er2045iwivp03)ï¼šå†…ç½®æ”¯æŒé˜¿é‡Œäº‘ã€AWSã€åä¸ºäº‘ã€è…¾è®¯äº‘ç­‰å¤šç§äº‘æœåŠ¡æä¾›å•†ï¼Œå¹¶å¯æŒ‰éœ€æ‰©å±•ä¸“æœ‰äº‘ï¼›å¹¶æä¾›äº†Collectoré‡‡é›†æ¡†æ¶ï¼Œå¯æŒ‰éœ€æ‹“å±•æ”¯æŒå…¶ä»–äº‘å‚å•†
+ ç”¨æˆ·å‹å¥½çš„é¡µé¢ï¼šç›´è§‚çš„UIç•Œé¢ï¼Œæ–¹ä¾¿ç”¨æˆ·è¿›è¡Œèµ„äº§ç®¡ç†ã€è§„åˆ™ç¼–è¾‘ã€é£é™©è¿è¥ï¼Œæ”¯æŒå¤šç§Ÿæˆ·

## ğŸŒŸ æ ¸å¿ƒèƒ½åŠ›çŸ©é˜µ

| åŠŸèƒ½æ¨¡å—     | ç‰¹æ€§æè¿°                                                     |
| ------------ | ------------------------------------------------------------ |
| **èµ„äº§å‘ç°** | è¦†ç›–ä¸»æµå…¬æœ‰äº‘å¹³å°ï¼Œè‡ªåŠ¨å‘ç°30+äº‘æœåŠ¡/200+èµ„æºç±»å‹ï¼Œæä¾›æ¡†æ¶çº§æ”¯æŒï¼Œå¯è½»æ¾çš„æŒ‰éœ€æ‹“å±• |
| **é£é™©æ£€æµ‹** | åŸºäºä¼ä¸šçº§çš„å®æˆ˜è§„åˆ™ï¼Œè¦†ç›–ç½‘ç»œé˜²æŠ¤ã€èº«ä»½å®‰å…¨ã€å®‰å…¨é˜²æŠ¤ã€æ•°æ®ä¿æŠ¤ã€æ—¥å¿—å®¡è®¡ç­‰å¤šç§åœºæ™¯ |
| **ç­–ç•¥å¼•æ“** | åŸºäºOPAçš„å£°æ˜å¼ç­–ç•¥ç®¡ç†ï¼Œå¯åŠ¨æ€è°ƒæ•´è§„åˆ™æ— ç¡¬ç¼–ç ï¼Œæ— éœ€é‡æ–°éƒ¨ç½² |
| **ä¿®å¤é—­ç¯** | é›†æˆä¼ä¸šå¾®ä¿¡/é’‰é’‰ï¼Œå‘Šè­¦ç­–ç•¥å¯çµæ´»é…ç½®                        |


---

# ğŸš€ å¿«é€Ÿå¼€å§‹

+ [docker compose éƒ¨ç½²](https://cloudrec.yuque.com/org-wiki-cloudrec-iew3sz/hocvhx/nx2syhgl3boeivqe)
+ [æ™®é€šéƒ¨ç½²](https://cloudrec.yuque.com/org-wiki-cloudrec-iew3sz/hocvhx/mq6ofobgh3tle32c)
+ [æœ¬åœ°å¼€å‘](https://cloudrec.yuque.com/org-wiki-cloudrec-iew3sz/hocvhx/ztshd0t0wuabshmc)

# ğŸ— ç³»ç»Ÿæ¶æ„

![arch](doc/images/arch.jpg)

# ğŸ“š æ ¸å¿ƒæ¦‚å¿µ

## ğŸ“¡ Collector é‡‡é›†å™¨

```yaml
# Collector name, if not configured, hostname will be used
AgentName: "Alibaba CloudHuawei Cloud,AWS,Tencent Cloud,GCP,Baidu Cloud Collector"
# The server URL, http://localhost:8080 is used by default, and can be adjusted according to actual conditions
ServerUrl: "http://localhost:8080"

# egï¼š@every 30sã€@every 5mã€@every 1h
# @every 5m means obtaining an account every five minutes. If the current task is finished, skip this task.
Cron: "@every 5m"

# If RunOnlyOnce is set to false, the program will be executed once immediately, but the program will not exit. It will be run regularly according to the Cron cycle.
# If RunOnlyOnce is set to true, the program will be executed once immediately and then exit.
RunOnlyOnce: false

# Access token, which is used to authenticate the request. You can get it from the server
AccessToken: "change your access token"

#  Deployment site. If the deployment site is configured as 'S1', only cloudAccount of this site can be obtained. If the deployment site is not configured, all cloudAccount can be obtained.
#  eg:["S1"]
#  eg:["S1","I2","TE"]
Sites: [  ]

# Pay attention to the risk error information. If the error message contains text, the risk will be submitted to the server
AttentionErrorTexts: [ "NoPermission", "NotAuthorized", "NotApplicable",
                       "Forbidden.RAM", "Forbidden", "Throttling.User", "Throttling", "InvalidAccessKeyId.NotFound", "ServiceUnavailable", "Forbidden" ]
```



## ğŸ“œ Rego ç­–ç•¥ç¤ºä¾‹

```javascript
package ecs_security_groups_misconfig
import rego.v1

default risk := false
risk if {
  has_public_address
  count(security_groups_misconfig) != 0
}

public_ip_address := input.Instance.PublicIpAddress.IpAddress
has_public_address if {
  count(public_ip_address) > 0
}

security_groups_misconfig contains sg_rule if {
  sg_rule := input.SecurityGroups[_].Permissions[_]
  parts := split(sg_rule.SourceCidrIp, "/")
  size := to_number(parts[1])
  size <= 8
  sg_rule.Direction == "ingress"
  sg_rule.Policy == "Accept"
}
```

# ğŸ¤ å‚ä¸è´¡çŒ®

## å¼€å‘æµç¨‹

1. Fork ä¸»ä»“åº“
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (git checkout -b feat/awesome-feature)
3. æäº¤ä»£ç  (git commit -am 'Add awesome feature')
4. æ¨é€åˆ†æ”¯ (git push origin feat/awesome-feature)
5. åˆ›å»º Pull Request

# **<font style="color:rgb(38, 38, 38);">ğŸ“¬</font>** è”ç³»æˆ‘ä»¬

![](https://cdn.nlark.com/yuque/0/2025/png/22047253/1747635633316-59227dad-e9a2-4971-b29d-eb7b5b5c1953.png)

# ğŸ“œ å¼€æºåè®®

æœ¬é¡¹ç›®é‡‡ç”¨ Apache-2.0 è®¸å¯è¯ï¼Œå®Œæ•´æ–‡æœ¬è¯·è§ LICENSE æ–‡ä»¶ã€‚å•†ä¸šä½¿ç”¨éœ€éµå®ˆè¡¥å……æ¡æ¬¾ã€‚

